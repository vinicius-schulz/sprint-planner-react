# Copilot Instructions

- Stack: React + Vite + TypeScript + Redux Toolkit + MUI; entry in [src/main.tsx](src/main.tsx) wraps [src/App.tsx](src/App.tsx) with theme and store.
- Run/build: `npm install`, `npm run dev`, `npm run build` (see [README.md](README.md)). No automated tests.
- Types/defaults: domain models and defaults in [src/domain/types.ts](src/domain/types.ts) and [src/domain/constants.ts](src/domain/constants.ts); `GlobalConfig` controls SP scale, overload thresholds, work periods, `schedulingStrategy` (default EDD), factors, and `storyPointsPerHour`.
- Calendar: working days built in [src/domain/services/capacityService.ts](src/domain/services/capacityService.ts) from `calendar.daySchedules` when present; otherwise sprint range minus weekends plus manual overrides. Day schedules created/edited in [src/features/sprint/SprintTab.tsx](src/features/sprint/SprintTab.tsx) using [buildDaySchedules](src/domain/services/workingCalendar.ts).
- Working hours: [computeWorkingHours](src/domain/services/capacityService.ts) sums per-day periods (or `dailyWorkHours`) and subtracts event minutes; recurring events deduct on every working day and floors at 0.
- Capacity: [computeMemberCapacity/computeTeamCapacity](src/domain/services/capacityService.ts) count only `countedMemberTypes`, applying availability %, seniority/maturity factors, and `storyPointsPerHour`.
- Scheduling: [computeTaskSchedules](src/domain/services/capacityService.ts) cleans deps, topologically orders, and fills minutes inside working periods. Duration = `ceil(SP / storyPointsPerHour * 60)` (turbo SP when enabled). Honors per-day capacity, extends past sprint end by appending default working days, errors on missing dates or cycles. Strategies: EDD, SPT, BLOCKERS, HYBRID (due + blockers + duration score).
- Tasks UI: [src/features/tasks/TasksTab.tsx](src/features/tasks/TasksTab.tsx) recomputes on change, flags overload via `workloadWarningOver`/`workloadErrorOver`, supports drag-and-drop ordering, turbo SP, due dates, and fires `task-manage-open` (also from [src/components/GanttTimelineFrappe/GanttTimelineFrappe.tsx](src/components/GanttTimelineFrappe/GanttTimelineFrappe.tsx)).
- Task detail: [src/features/tasks/TaskInfoDialog.tsx](src/features/tasks/TaskInfoDialog.tsx) shows per-day capacity/events/factors via `computedTimeline.detail`.
- Gantt: [src/components/GanttTimelineFrappe/GanttTimelineFrappe.tsx](src/components/GanttTimelineFrappe/GanttTimelineFrappe.tsx) renders Frappe Gantt from `selectTaskSchedules`, colors by assignee, and dispatches `task-manage-open` on bar click.
- Summary: [src/components/SummaryBoard/SummaryBoard.tsx](src/components/SummaryBoard/SummaryBoard.tsx) displays working days/hours, team capacity, member count, and counted-role SP totals.
- Events: [src/features/events/EventsTab.tsx](src/features/events/EventsTab.tsx) manages events; durations accept minutes/hours/days (converted with `config.dailyWorkHours`); `recurringDaily` applies to every working day.
- Team: [src/features/members/TeamTab.tsx](src/features/members/TeamTab.tsx) manages members; advanced availability converts minute events to availability %. `renameAssignee` propagates member renames to tasks.
- Config: [src/features/config/ConfigTab.tsx](src/features/config/ConfigTab.tsx) edits `GlobalConfig`; validates JSON factors, period strings `HH:mm-HH:mm;...`, SP scale, overload thresholds. Invalid input shows inline error.
- Sprint: [src/features/sprint/SprintTab.tsx](src/features/sprint/SprintTab.tsx) validates dates, updates sprint slice, regenerates day schedules; allows toggling non-working days and up to two periods per day.
- Calendar overrides: [src/features/calendar/NonWorkingDaysTab.tsx](src/features/calendar/NonWorkingDaysTab.tsx) marks manual non-working days and can “remove” weekends from the non-working set.
- Import/Export: [src/features/importExport/ImportExportTab.tsx](src/features/importExport/ImportExportTab.tsx) exports JSON with version `Calculadora de Capacidade Scrum – v1.0`; importing requires `sprint` and `globalConfig` and replaces calendar, events, members, tasks, and config slices.
- Reset: [src/components/NewSchedulePanel/NewSchedulePanel.tsx](src/components/NewSchedulePanel/NewSchedulePanel.tsx) resets sprint/calendar and optionally keeps team, tasks (dates cleared), events, or config.
- Reporting: [src/components/ReportExport/ReportExportButton.tsx](src/components/ReportExport/ReportExportButton.tsx) builds print-ready HTML/PDF summary of sprint, capacity, events, task timeline, and calendar stats.
- Projects + multi-sprint hub: projects/sprints live in localStorage via [src/app/sprintLibrary.ts](src/app/sprintLibrary.ts). Projects route `/projects`; sprints per project at `/projects/:projectId/sprints`; planning/follow-up keep `/plan/:sprintId` and `/acomp/:sprintId`. `useEnsureActiveSprint` hydrates per sprint ID, library stores project meta and ties each sprint to a `projectId`. Lifecycle: `editing` → `followup` (save in ReviewTab) → `closed` (finalize in FollowUpPage) with `reopenFollowUp` and `reopenPlanning` to unlock.
- Persistence expectations: imports overwrite store; new schedule resets clear computed fields; saving is automatic—no manual persist hooks needed.
- Hooks/typing: use `useAppDispatch`/`useAppSelector` from [src/app/hooks.ts](src/app/hooks.ts); state matches `RootPersistedState` in [src/domain/types.ts](src/domain/types.ts).
- UX cues: overload warnings appear in TasksTab banners and row coloring; Gantt accordion defaults collapsed; Summary/Report rely on selectors—keep them in sync when adding slices.
